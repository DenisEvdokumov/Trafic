package tapmoney;

import java.math.BigInteger;


import org.json.simple.JSONArray;
import org.json.simple.JSONObject;
import org.json.simple.JSONValue;
import org.json.simple.parser.JSONParser;
import org.json.simple.parser.ParseException;
//import one.FirstStep;

public class Keyex {
	
	//sequence - 433
	//keyAES - 2ffu2U3XHWUMcdCX
	//keyMAC - gWaedhXoQS8N6Moa

	//----------- Параметры запроса ----------

	//sequence - pVeDmo/WunA/CCCFUPDjTw==
	//sequenceMAC - 9e4x7zWP9RHDLLtv4Im6zkUTGiVEigVd6xuXCjUVtR8=
	//encryptedKeyAES - 1029046230508985735117126704831011458455528156520485036497565682974508015202947800930139320571904040071022831852574223676703253456358295472647845309994838|908227186248971830130572295064556303090255012435411738919891643604968859008766529320154885668424768275904571074178371916684686974745498149028492298815307|908227186248971830130572295064556303090255012435411738919891643604968859008766529320154885668424768275904571074178371916684686974745498149028492298815307|2986852577657821229977315309823886325946721415846819880351627002833486560363872782731503873157932546078875488027663986720329106858344648942358003712274082|1029046230508985735117126704831011458455528156520485036497565682974508015202947800930139320571904040071022831852574223676703253456358295472647845309994838|553132107434021666697332482127795452082062750322379425344970379760587203476763370310307902188084806924018227869874233027929620676366567124872049093600840|2846725482228259349630351475736276348018530838951701930885273384334385807937955359492453722229675777847734266583186278847041959371009343358578835476774534|726516216580919147888863728216099834576327978517967399818985633120787823385516109424570554852186878087886565232759693774509779486497247022530497966313670|3991655153482467050714749106489861832388344873436425122440392999364508840394385787567466630849918426170339247585573624775614672087972697674345224076457919|2728535310722027382062019280974074864004432616686688326934941485254661023988326872701343228006298104830604122282713500791026318358711021086711546168922877|553132107434021666697332482127795452082062750322379425344970379760587203476763370310307902188084806924018227869874233027929620676366567124872049093600840|3428289207929714310351585701732316046835135554326518300962230080232368783102013866849817799065662997654702240546772879888750313741308114691946154189736144|2713360716700088824780118051908184197882375075631664640132494481826863550654293536223133526349552198568761886083544192727702216027822310959701308687855873|2506970142467470187182626746648161464074006935827779088883018768971830325988080611079453395423508994031181597145761535783913755390724945076469381528468274|1286996349744524032080162586270560135050295407775810708365101364551921806135052840793866354677966619575311897274509717291312478853509158576737917490037963|726516216580919147888863728216099834576327978517967399818985633120787823385516109424570554852186878087886565232759693774509779486497247022530497966313670
	//encryptedKeyMAC - 2201769431422441966877117304796390281720316640368155225009541761781212745122791520484136332282086289712020748419254016604565620114588773652579016307833621|2728535310722027382062019280974074864004432616686688326934941485254661023988326872701343228006298104830604122282713500791026318358711021086711546168922877|2115436990745748369076809205398922375845449024370637477852948123905252742785294706975139610894015110572016621833456857558621485510673737793562526889011006|2463371469547441169896091287895945220373283223053511430585349208431597347091109260266282437579622318790514482231839840668915126330709192446428210911509889|2506970142467470187182626746648161464074006935827779088883018768971830325988080611079453395423508994031181597145761535783913755390724945076469381528468274|104416582784302897829927810826306559718215648455400406021184815218620593710190552353234190427130009929879137537883984161546607621250910992748961349873249|726516216580919147888863728216099834576327978517967399818985633120787823385516109424570554852186878087886565232759693774509779486497247022530497966313670|2819547793756766771361230464940453180064911383741601481869588033276663295298253413459452210576400840877242168415502466897687744790384790362950333723605477|3694687533453249889087801836752359933389281097839594409444913944108838923446937735130858660281705799089526446965998182247158126641048738383062554111759224|4090949629777024546307209554894986028316444537104652883129458357269074069790667463410300407266727434565108934814788331823995740292538997276318282172612073|3849291410481811060711860467543358128687549621779918975176682819875849954904728198507867845774168666873330132812928729690495810330821645268577690997038856|1159638600864668756245018791698093881448714391332808284726734617892843669061974330602493241364490257540592681767142467256157305354565981516903188523406329|1497126968632102573035686366744488911428542975874024956604872214062068135920846263634146729488357551793961208358514698686052884564166352115001034186675354|3428289207929714310351585701732316046835135554326518300962230080232368783102013866849817799065662997654702240546772879888750313741308114691946154189736144|2819547793756766771361230464940453180064911383741601481869588033276663295298253413459452210576400840877242168415502466897687744790384790362950333723605477|2115436990745748369076809205398922375845449024370637477852948123905252742785294706975139610894015110572016621833456857558621485510673737793562526889011006
	
	public static void main(String[] args) {
				
		//Keyex.setKeys();
		Keyex.confirm();
	}
	
	
	public static void setKeys() {
		
		String keyAES = Security.getKey();
		String keyMAC = Security.getKey();
		
		String action = "setKeys";
		
		String sequence = Integer.toString(Security.getSequence());
		String sequenceAES = Security.encrypt(sequence, keyAES);
		String sequenceMAC = Security.encrypt(sequenceAES, keyMAC);
		
		BigInteger keyMod = new BigInteger("4128129803496668451833756170118141868851614705806314994203614389510613404539543352564468242326067417323817062813109724033546102916918446969287233378526867");
		BigInteger keyExp = new BigInteger("3127925502487553883617082248057751761281245073620963837458066168905990700262438767821460201762431802142515638993587131725483191226686428040565351502696063");
		
		
		String encryptedKeyAES = Security.encryptRSA(keyAES, keyExp, keyMod);
		String encryptedKeyMAC = Security.encryptRSA(keyMAC, keyExp, keyMod); 
		
		System.out.println("sequence - "+sequence);
		System.out.println("keyAES - "+keyAES);
		System.out.println("keyMAC - "+keyMAC);
		
		System.out.println("\n----------- Параметры запроса ----------\n");
		
		//System.out.println("sequence - "+sequenceAES);
		//System.out.println("sequenceMAC - "+sequenceMAC);
		//System.out.println("encryptedKeyAES - "+encryptedKeyAES);
		//System.out.println("encryptedKeyMAC - "+encryptedKeyMAC);
		
		JSONObject json = new JSONObject();
		
		json.put("action", action);
		json.put("sequence", sequenceAES);
		json.put("sequence_MAC", sequenceMAC);
		json.put("encryptedKeyAES", encryptedKeyAES);
		json.put("encryptedKeyMAC", encryptedKeyMAC);
		
		System.out.println(json.toString());
		
	}
	
	
	
	
	public static void confirm() {
		
		String keyAES = "r5ZbzeCRFux1JXjB";
		String keyMAC = "b4cHM4WKeNIjTD0S";
		//String keyAES = "";
		//String keyMAC = "";
		
		String action = "confirm";
		//String actionMAC = "confirm";
		
		String idSession = "133";
		//String idSessionAES = Security.encrypt(idSession, keyAES);
		String idSessionMAC = Security.encrypt(idSession, keyMAC);
		
		int keysConfirm = 1;
		
		String string = Security.getString();
		//String stringAES = Security.encrypt(string, keyAES);
		String stringMAC = Security.encrypt(string, keyMAC);
		
		String sequence = "212";
		String sequenceAES = Security.encrypt(sequence, keyAES);
		String sequenceMAC = Security.encrypt(sequenceAES, keyMAC);
		
		
		System.out.println("sequence - "+sequence);
		System.out.println("keyAES - "+keyAES);
		System.out.println("keyMAC - "+keyMAC);
		
		System.out.println("\n----------- Параметры запроса ----------\n");
		
		//System.out.println("sequence - "+sequenceAES);
		//System.out.println("sequenceMAC - "+sequenceMAC);
		//System.out.println("encryptedKeyAES - "+encryptedKeyAES);
		//System.out.println("encryptedKeyMAC - "+encryptedKeyMAC);
		
		JSONObject json = new JSONObject();
		
		json.put("action", action);
		json.put("idSession", idSession);
		json.put("idSession_MAC", idSessionMAC);
		json.put("keysConfirm", keysConfirm);
		json.put("string", string);
		json.put("string_MAC", stringMAC);
		json.put("sequence", sequenceAES);
		json.put("sequence_MAC", sequenceMAC);
		//json.put("encryptedKeyAES", encryptedKeyAES);
		//json.put("encryptedKeyMAC", encryptedKeyMAC);
		
		System.out.println(json.toString());
		
	}
	
}